{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "WorldShare Scene Cohort Schema",
  "description": "Standardized scene repository schema for M1/M2 calibration",
  "version": "1.0.0",
  "type": "object",
  "required": ["version", "cohort_id", "metadata", "scenes"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version (semver)"
    },
    "cohort_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this scene cohort"
    },
    "metadata": {
      "type": "object",
      "required": ["created_at", "created_by", "description", "total_scenes", "total_size_gb"],
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "created_by": {
          "type": "string",
          "description": "Team or system that created this cohort"
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of the cohort"
        },
        "total_scenes": {
          "type": "integer",
          "minimum": 1
        },
        "total_size_gb": {
          "type": "number",
          "minimum": 0
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "scenes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/Scene"
      }
    }
  },
  "definitions": {
    "Scene": {
      "type": "object",
      "required": [
        "scene_id",
        "name",
        "category",
        "complexity",
        "source_format",
        "assets",
        "metrics",
        "ground_truth"
      ],
      "properties": {
        "scene_id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique scene identifier"
        },
        "name": {
          "type": "string",
          "description": "Human-readable scene name"
        },
        "category": {
          "type": "string",
          "enum": ["indoor", "outdoor", "complex", "hybrid"],
          "description": "Scene classification"
        },
        "complexity": {
          "type": "string",
          "enum": ["simple", "moderate", "complex", "extreme"],
          "description": "Complexity level"
        },
        "source_format": {
          "type": "string",
          "enum": ["blend", "fbx", "usd", "gltf", "unity"],
          "description": "Original file format"
        },
        "assets": {
          "$ref": "#/definitions/SceneAssets"
        },
        "metrics": {
          "$ref": "#/definitions/SceneMetrics"
        },
        "ground_truth": {
          "$ref": "#/definitions/GroundTruth"
        },
        "optimization_hints": {
          "$ref": "#/definitions/OptimizationHints"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "SceneAssets": {
      "type": "object",
      "required": ["source_url", "size_mb"],
      "properties": {
        "source_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to download source scene file"
        },
        "textures_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to texture archive if separate"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["texture", "model", "shader", "script"]
              },
              "name": {
                "type": "string"
              },
              "url": {
                "type": "string",
                "format": "uri"
              },
              "size_mb": {
                "type": "number"
              }
            }
          }
        },
        "size_mb": {
          "type": "number",
          "minimum": 0,
          "description": "Total size in megabytes"
        },
        "checksum": {
          "type": "string",
          "description": "SHA256 checksum of source file"
        }
      }
    },
    "SceneMetrics": {
      "type": "object",
      "required": ["vertex_count", "face_count", "object_count", "material_count"],
      "properties": {
        "vertex_count": {
          "type": "integer",
          "minimum": 0
        },
        "face_count": {
          "type": "integer",
          "minimum": 0
        },
        "object_count": {
          "type": "integer",
          "minimum": 0
        },
        "material_count": {
          "type": "integer",
          "minimum": 0
        },
        "texture_count": {
          "type": "integer",
          "minimum": 0
        },
        "total_texture_memory_mb": {
          "type": "number",
          "minimum": 0
        },
        "has_animation": {
          "type": "boolean",
          "default": false
        },
        "animation_frames": {
          "type": "integer",
          "minimum": 0
        },
        "has_particles": {
          "type": "boolean",
          "default": false
        },
        "has_volumetrics": {
          "type": "boolean",
          "default": false
        },
        "has_transparency": {
          "type": "boolean",
          "default": false
        },
        "bounding_box": {
          "type": "object",
          "properties": {
            "min": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "minItems": 3,
              "maxItems": 3
            },
            "max": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "minItems": 3,
              "maxItems": 3
            }
          }
        }
      }
    },
    "GroundTruth": {
      "type": "object",
      "required": ["reference_renders"],
      "properties": {
        "reference_renders": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["view_name", "resolution", "url"],
            "properties": {
              "view_name": {
                "type": "string",
                "description": "Name of the camera view"
              },
              "resolution": {
                "type": "string",
                "pattern": "^\\d+x\\d+$",
                "description": "Resolution (e.g., '1920x1080')"
              },
              "url": {
                "type": "string",
                "format": "uri",
                "description": "URL to reference render image"
              },
              "render_time_seconds": {
                "type": "number",
                "minimum": 0,
                "description": "Time taken to render this view"
              },
              "quality_metrics": {
                "type": "object",
                "properties": {
                  "ssim": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  },
                  "psnr": {
                    "type": "number",
                    "minimum": 0
                  },
                  "lpips": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  }
                }
              }
            }
          }
        },
        "optimal_settings": {
          "type": "object",
          "description": "Known optimal optimization settings",
          "properties": {
            "recommended_path": {
              "type": "string",
              "enum": ["baking", "gaussian-splatting", "hybrid"]
            },
            "baking_resolution": {
              "type": "integer"
            },
            "gaussian_splat_count": {
              "type": "integer"
            },
            "notes": {
              "type": "string"
            }
          }
        },
        "baseline_performance": {
          "type": "object",
          "properties": {
            "fps_unoptimized": {
              "type": "number",
              "minimum": 0
            },
            "fps_target": {
              "type": "number",
              "minimum": 0
            },
            "memory_usage_mb": {
              "type": "number",
              "minimum": 0
            },
            "gpu_utilization_percent": {
              "type": "number",
              "minimum": 0,
              "maximum": 100
            }
          }
        }
      }
    },
    "OptimizationHints": {
      "type": "object",
      "properties": {
        "suggested_pipeline": {
          "type": "string",
          "enum": ["baking", "gaussian-splatting", "hybrid", "auto"],
          "description": "Suggested optimization pipeline"
        },
        "critical_areas": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "description": {
                "type": "string"
              },
              "bounding_box": {
                "type": "object",
                "properties": {
                  "min": {
                    "type": "array",
                    "items": {
                      "type": "number"
                    },
                    "minItems": 3,
                    "maxItems": 3
                  },
                  "max": {
                    "type": "array",
                    "items": {
                      "type": "number"
                    },
                    "minItems": 3,
                    "maxItems": 3
                  }
                }
              },
              "importance": {
                "type": "string",
                "enum": ["low", "medium", "high", "critical"]
              }
            }
          }
        },
        "known_issues": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "optimization_notes": {
          "type": "string",
          "description": "Free-form notes about optimization strategies"
        }
      }
    }
  }
}